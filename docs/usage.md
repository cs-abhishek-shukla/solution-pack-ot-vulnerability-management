| [Home](../README.md) |
| -------------------- |

# Usage

Refer to [Simulate Scenario documentation](https://github.com/fortinet-fortisoar/solution-pack-soc-simulator/blob/develop/docs/usage.md) to understand how to simulate and reset scenarios.

To understand the process FortiSOAR follows to manage vulnerabilities in Operational Technology (OT), we have included a simulation mode. It provides a solution for handling the Known Exploited Vulnerability (KEV) CVEs under ICS Advisories . We have included a scenario &mdash; **OT - Known Exploit Vulnerability (KVE) Alert Raised For Asset At Risk** with this solution pack.

Refer to the section **OT - Vulnerability Management** to understand how this solution pack automation addresses your needs.

## Simulation mode

<table>
    <tr>
        <th>NOTE</th>
    </tr>
    <tr>
        <td>
            Before using the simulation mode, make the following configurations are in place:
            <ol>
                <li>To use actual data of listed CVEs, configure the <strong><em>NIST National Vulnerability Database</em></strong> connector.</li>
                <li>Set global variable <code>Demo_mode</code> to <em><code>true</code></em>. Refer to the section <a href="https://docs.fortinet.com/document/fortisoar/7.4.3/playbooks-guide/488685/dynamic-values#Global_Variables">Global Variables</a> in the <strong>Playbooks Guide</strong> of the platform documentation for more information.</li>
            </ol>
        </td>
    </tr>
</table>

The simulation mode has some sample data that helps you get a better understanding of how the solution pack functions. The following steps help you use the solution pack with the included sample data.

1. Browse to **Simulations** > **OT - Known Exploited Vulnerability (KEV) Alert Raised For Asset At Risk**.

2. Select the scenario and click **Simulate Scenario**.

3. Navigate to **Resources** > **Assets**. Following records are created:
    
    - Stratix Services Router - 6241
    
    - Stratix Services Router - RA41RT

4. Navigate to **Vulnerability Management** > **CVEs**. Following records are created:

    - CVE-2018-0158

    - CVE-2018-0151

    - CVE-2018-0175

5. Navigate to **OT Vulnerability Management** > **ICS Advisory**. Following records are created:

    - Rockwell Automation Stratix Services Router - (ICSA-18-107-03)

6. Navigate to **OT Vulnerability Management** > **KVE Alerts**. Following records are created:

    - Known Exploited Vulnerability (KEV) CVE CVE-2018-0158 associated with product Stratix Industrial Managed Ethernet

    - Known Exploited Vulnerability (KEV) CVE CVE-2018-0151 associated with product Stratix Industrial Managed Ethernet

    - Known Exploited Vulnerability (KEV) CVE CVE-2018-0175 associated with product Stratix Industrial Managed Ethernet

    > **NOTE** These alert are created after exploited CVEs are found in ICS Advisory.

6. Open a KEV alert.
    
    1. Click the **Identification** tab to view the the steps to be performed.
    
    2. Click the **Evaluation** tab to view the following records:

        - CVE-2018-0158 - ICSA-18-107-03 - State Of Exploitation **Urgent**

        - CVE-2018-0158 - ICSA-18-107-03 - Technical Impact **Urgent**

        - CVE-2018-0158 - ICSA-18-107-03 - Automatable **Urgent**

        - CVE-2018-0158 - ICSA-18-107-03 - Mission Prevalence **Urgent**

        - CVE-2018-0158 - ICSA-18-107-03 - Public Well-Being Impact **Urgent**

        - CVE-2018-0158 - ICSA-18-107-03 - Mitigation Status **Urgent**

        - CVE-2018-0151 - ICSA-18-107-03 - State Of Exploitation **Urgent**

        - CVE-2018-0151 - ICSA-18-107-03 - Technical Impact **Urgent**

        - CVE-2018-0151 - ICSA-18-107-03 - Automatable **Urgent**

        - CVE-2018-0151 - ICSA-18-107-03 - Mission Prevalence **Urgent**

        - CVE-2018-0151 - ICSA-18-107-03 - Public Well-Being Impact **Urgent**

        - CVE-2018-0151 - ICSA-18-107-03 - Mitigation Status **Urgent**

        - CVE-2018-0175 - ICSA-18-107-03 - State Of Exploitation **Urgent**

        - CVE-2018-0175 - ICSA-18-107-03 - Technical Impact **Urgent**

        - CVE-2018-0175 - ICSA-18-107-03 - Automatable **Urgent**

        - CVE-2018-0175 - ICSA-18-107-03 - Mission Prevalence **Urgent**

        - CVE-2018-0175 - ICSA-18-107-03 - Public Well-Being Impact **Urgent**

        - CVE-2018-0175 - ICSA-18-107-03 - Mitigation Status **Urgent**

    2. Click the **Remediation** tab to view the following records:

        - CVE-2018-0158 - ICSA-18-107-03 - Make Permanent Configuration Changes

        - CVE-2018-0158 - ICSA-18-107-03 - Isolating vulnerable systems, applications, services, profiles, or other assets

        - CVE-2018-0158 - ICSA-18-107-03 - Limiting access

    3. Execute the playbook **Get Latest Report Of CVEs** to get the latest report of CVEs from NIST's NVD.


    4. To complete the tasks, execute one of the following playbooks available for each task:

        - Vulnerability - Provide Evidence of Exploitation

        - Vulnerability Technical Impact - Provide Status

        - Vulnerability Automatable - Provide Decision

        - Vulnerability - Provide Impact on MEFs

        - Vulnerability - Provide Public Well-Being Impact

        - Vulnerability Mitigation - Provide Status

    5. After completing the tasks, execute **Calculate SSVC Score** to determine the score for each KEV CVE. The **Evaluation** tab contains SSVC Score.

    ![SSVC Score](./res/ssvc_score.png)

    6. Select **Yes**, **No**, or **Unknown** in the **Remediation** tab for the question - **Do Patches Exist?**

        <table>
            <tr>
                <th>NOTE</th>
                <td>
                    If the query value changes, the related task for the patch is deleted and a new task is created. On selecting <strong><em>Unknown</em></strong> related patch task is deleted.
                </td>
            </tr>
        </table>

    7. **Reporting & Notification** tab contains the details of the report and any additional notes to be added to the report.

    8. To create a report, run **Generate Status Summary Report**.

<table>
    <tr>
        <th>NOTE</th>
        <td>
            Mark <strong>Does Patch Exist?</strong> as <strong><em>Unknown</em></strong> before resetting the scenario.
        </td>
    </tr>
</table>

## Production Mode

1. Set global variable `Demo_mode` to *`true`*. Refer to the section [Global Variables](https://docs.fortinet.com/document/fortisoar/7.4.3/playbooks-guide/488685/dynamic-values#Global_Variables) in the **Playbooks Guide** of the platform documentation for more information.</li>

2. In **02 - Use Case - ICS Advisory and CVEs** and **02 - Use Case - KEV Alert** playbook collections, select and mark all the playbooks as **_Active_**.

3. Ingest Known Exploited Vulnerabilities (KEV) CVEs published by *Cybersecurity and Infrastructure Security Agency (CISA)* using any of the following methods:

    - Trigger the schedule **Ingest Known Exploited Vulnerabilities (KEV) CVEs**

    - Execute **Ingest Known Exploited Vulnerabilities (KEV) CVEs** from `CVE` module List View.

    <table>
        <tr>
            <th>NOTE</th>
            <td>
                Wait for the ingestion to complete.
            </td>
        </tr>
    </table>

4. Consider the following when ingesting advisories:

    - To get ICS Advisory execute the playbook **Ingest CISA ICS Advisory**.

    - To get ICS Medical Advisory, execute the playbook **Ingest CISA ICS Medical Advisory**.

    - CVE records are created and marked as a KEV, if any of the CVEs is found in **Known Exploited Vulnerabilities (KEV) Catalog**

    - Assets are correlated with ICS Advisories if the asset is found for the same vendor and product as that of the ICS Advisory.

        <table>
            <tr>
                <th>NOTE</th>
                <td>
                    Activate the schedule <strong>Ingest CISA ICS Advisory</strong> and <strong>Ingest CISA ICS Medical Advisory</strong> to ingest daily-released CISA Advisories.
                </td>
            </tr>
        </table>

5. Consider the following for KEV alerts:

    - When a KEV ICS advisory is created, a **KEV Alert** is generated if it is discovered in the KEVs and the system contains assets from the same vendor as that of the advisory.

    - Trigger the **Create KEV Alert** playbook on KEV ICS Advisory to create **KEV Alert**.

    - Assigned person gets In-App and email notifications.

## OT - Vulnerability Management Views

## ICS Advisory

![](./res/ics_advisory_view.png)

## KEV Alerts

| ![](./res/kev_alert_identification.png) | ![](./res/kev_alert_evaluation.png) |
|:----------------------------------------|:------------------------------------|
| Identification Tab                      | Evaluation Tab                      |

| ![](./res/kev_alert_remediation.png) | ![](./res/kev_alert_report.png) |
|:-------------------------------------|:--------------------------------|
| Remediation Tab                      | Report Tab                      |

# Next Steps

| [Installation](./setup.md#installation) | [Configuration](./setup.md#configuration) | [Contents](./contents.md) |
|-----------------------------------------|-------------------------------------------|---------------------------|