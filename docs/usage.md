| [Home](../README.md) |
| -------------------- |

# Usage

Refer to [Simulate Scenario documentation](https://github.com/fortinet-fortisoar/solution-pack-soc-simulator/blob/develop/docs/usage.md) to understand how to simulate and reset scenarios.

To understand the process FortiSOAR follows to manage vulnerabilities in Operational Technology (OT), we have included a simulation mode. It provides a solution for handling the Known Exploited Vulnerability (KEV) ICS Advisory Alert. We have included a scenario &mdash; **OT - Known Vulnerability Exploit (KVE) Alert Raised For Asset At Risk** with this solution pack.

Refer to the section **OT - Vulnerability Management** to understand how this solution pack automation addresses your needs.

## Simulation mode

The simulation mode has some sample data that helps you get a better understanding of how the solution pack functions. The following steps help you use the solution pack with some included sample data.

### Before Running the Simulation:

1. Run the Simulation **OT - Add Sample Assets** from **OT - Asset Management** solution pack to get sample Assets.
2. To get real data of listed CVEs configure **National Vulnerability Database**

**OT - Known Vulnerability Exploit (KVE) Alert Raised For Asset At Risk**

- Browse to **Simulations** > **OT - Known Vulnerability Exploit (KVE) Alert Raised For Asset At Risk** scenario and click Simulate Scenario.
- List of Records gets created.
    - CVEs:
        - CVE-2018-0158, CVE-2018-0151, CVE-2018-0175
    - ICS Advisory:
        - Rockwell Automation Stratix Services Router - (ICSA-18-107-03)
    - On Creation of KEV ICS Advisory KEV Alert get created:
        - CVE-2018-0158 - ICSA-18-107-03
        - CVE-2018-0151 - ICSA-18-107-03
        - CVE-2018-0175 - ICSA-18-107-03
    - Mandatory Tasks(Under Evaluation Tab):
        - CVE-2018-0158 - ICSA-18-107-03 - State Of Exploitation **Urgent**
        - CVE-2018-0158 - ICSA-18-107-03 - Technical Impact **Urgent**
        - CVE-2018-0158 - ICSA-18-107-03 - Automatable **Urgent**
        - CVE-2018-0158 - ICSA-18-107-03 - Mission Prevalence **Urgent**
        - CVE-2018-0158 - ICSA-18-107-03 - Public Well-Being Impact **Urgent**
        - CVE-2018-0158 - ICSA-18-107-03 - Mitigation Status **Urgent**
        - CVE-2018-0151 - ICSA-18-107-03 - State Of Exploitation **Urgent**
        - CVE-2018-0151 - ICSA-18-107-03 - Technical Impact **Urgent**
        - CVE-2018-0151 - ICSA-18-107-03 - Automatable **Urgent**
        - CVE-2018-0151 - ICSA-18-107-03 - Mission Prevalence **Urgent**
        - CVE-2018-0151 - ICSA-18-107-03 - Public Well-Being Impact **Urgent**
        - CVE-2018-0151 - ICSA-18-107-03 - Mitigation Status **Urgent**
        - CVE-2018-0175 - ICSA-18-107-03 - State Of Exploitation **Urgent**
        - CVE-2018-0175 - ICSA-18-107-03 - Technical Impact **Urgent**
        - CVE-2018-0175 - ICSA-18-107-03 - Automatable **Urgent**
        - CVE-2018-0175 - ICSA-18-107-03 - Mission Prevalence **Urgent**
        - CVE-2018-0175 - ICSA-18-107-03 - Public Well-Being Impact **Urgent**
        - CVE-2018-0175 - ICSA-18-107-03 - Mitigation Status **Urgent**
    - Recommended Tasks(Under Remediation Tab):
        - CVE-2018-0158 - ICSA-18-107-03 - Make Permanent Configuration Changes
        - CVE-2018-0158 - ICSA-18-107-03 - Isolating vulnerable systems, applications, services, profiles, or other assets
        - CVE-2018-0158 - ICSA-18-107-03 - Limiting access
- To get the latest report of CVEs from NIST-NVD, execute the playbook **Get Latest Report Of CVEs**
- Identification tab contains the steps to be performed.
- Execute the appropriate playbook that is available by task type to complete all the **Mandatory Tasks**.
- After completing all **Mandatory Tasks**, execute **Calculate SSVC Score** to determine the score for each KEV CVE. The evaluation tab contains SSVC Score.
![SSVC Score](/docs/res/ssvc_score.png)
- Remediation tab also contains patch existence query as **Yes** or **No**. For each option related task gets created.
> **Note**: If the query value changes, the related task for the patch gets deleted and a new task gets created. On selecting **unknown** related patch task gets deleted.
- Reporting & Notification tab contains the details of the report and Additional Notes to be added to the report.
- To create a report, run **Generate Status Summary Report**.

> **Note**: Please mark **Does Patch Exist?** as **unknown** before reseting scenario

## Real Mode

- Set global variable **Demo_mode** as **false**.
- In **02 - Use Case - ICS Advisory and CVEs** and **02 - Use Case - KEV Alert**, mark all of the playbooks that are available as active.
- Ingest KEV CVE using any of the below ways:
    - Trigger the schedule **Ingest Known Exploited Vulnerabilities (KEV) CVEs** to get all the KEV CVEs from NIST-NVD.
    - Execute **Ingest Known Exploited Vulnerabilities (KEV) CVEs** from `CVE` module List View.
    > **Note**: Please wait till ingestion gets over.to acquire given number of data per page.
- Ingest ICS Advisory using any of the below ways:
    - Manualy execute the playbook **Ingest CISA Advisories** to get all CISA Advisories.
    - Execute **Ingest CISA Advisories** from `ICS Advisory` module List View.
    > **Note** Mark schedule **Ingest Latest CISA ICS Advisory** and **Ingest Latest CISA ICS Medical Advisory** as `Active` to ingest daily released CISA Advisories.
    - On ICS Advisory creation:
        - CVE records gets created and if any of CVE is found in **Known Exploited Vulnerabilities (KEV) Catalog**, Advisory get marked as `KEV`.
        - Assets gets correlated with ICS Advisory if asset is found for same `vendor` and `product` as of ICS Advisory.
- KEV Alert Creation:
    - If `Known Exploited Vulnerabilities (KEV) CVE` and `Asset` is found in ICS Advisory, KEV Alert gets created for each **Known Exploited Vulnerabilities (KEV) CVE**
    - Tigger **Create KEV Alert** on KEV ICS Advisory to create **KEV Alert**.
    - Assigned person gets In-App Notification and notification via mail.

## OT - Vulnerability Management Views

## ICS Advisory
![](./res/ics_advisory_view.png)

## KEV Alert

| ![](./res/kev_alert_identification.png) | ![](./res/kev_alert_evaluation.png) |
| :-------------------------------------- | :---------------------------------- |
| Identification Tab                      | Evaluation Tab                      |

| ![](./res/kev_alert_remediation.png) | ![](./res/kev_alert_report.png) |
| :----------------------------------- | :------------------------------ |
| Remediation Tab                      | Report Tab                      |