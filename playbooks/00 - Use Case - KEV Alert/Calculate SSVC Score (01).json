{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Calculate SSVC Score (01)",
    "aliasName": null,
    "tag": null,
    "description": null,
    "isActive": false,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/db7036e6-4e35-4479-beea-d7fefc73ab68",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/19be9823-6bb2-45fb-8958-a19d32635aff",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "473a5e41-8a52-4afb-bbe3-066426c4118c",
                "resources": [
                    "k_e_v_alerts",
                    "c_v_es"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": "{{vars.input.records}}"
                    }
                },
                "displayConditions": {
                    "tasks": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    },
                    "c_v_es": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    },
                    "k_e_v_alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    },
                    "mitre_mitigations": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "group": null,
            "uuid": "19be9823-6bb2-45fb-8958-a19d32635aff"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get SSVC Color And Text",
            "description": null,
            "arguments": {
                "ssvcText": "{{vars.finalOutputtMap.get(vars.ssvcFinalOutput)}}",
                "ssvcColor": "{{\"SSVCCalculator\" | picklist(vars.ssvcFinalOutput, \"color\")}}"
            },
            "status": null,
            "top": "1110",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "277bb1bf-cd75-407e-bde7-2f0abd1bda61"
        },
        {
            "@type": "WorkflowStep",
            "name": "Incomplete Tasks",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Incomplete Tasks",
                        "description": "<h6>Please complete list of remaining tasks:\n<hr>\n{% for task in vars.incompleteTask %}\n<li><a href=\"\/modules\/tasks\/{{task.uuid}}\">{{task.name}}<\/a><\/li>\n{% endfor %}\n<\/h6>\n\n",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "resources": "k_e_v_alerts",
                "owner_detail": {
                    "isAssigned": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Ok",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/b6702a9a-cb6d-4c69-9475-f619be43ddaf"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                }
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "3673cd56-0ba7-403e-afaa-781f3eb977be"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update KEV Alert",
            "description": null,
            "arguments": {
                "resource": {
                    "vulnerabilityAssignment": "<p><svg height=\"70\" width=\"1000\"> <g> <circle cx=\"20\" cy=\"55\" r=\"10\" style=\"fill: #b0c4de; stroke: #3598db;\"><\/circle> <text x=\"0\" y=\"30\" style=\"font-size: 15px; fill: #FFFFFF;\">Exploitation<\/text> <path id=\"chk1\" d=\"M 30,55 C 30,55 30,55 240,55\" style=\"stroke: #3598db; stroke-width: 2;\"><\/path> <text style=\"stroke: #3598db;\" dy=\"48\" dx=\"120\" text-anchor=\"middle\"> {{vars.exploitation}} <\/text> <\/g> <g> <circle cx=\"240\" cy=\"55\" r=\"10\" style=\"fill: #b0c4de; stroke: #3598db;\"><\/circle> <text x=\"200\" y=\"30\" style=\"font-size: 15px; fill: #FFFFFF;\">Automatable<\/text> <path id=\"chk2\" d=\"M 250,55 C 250,55 250,55 460,55\" style=\"stroke: #3598db; stroke-width: 2;\"><\/path> <text style=\"stroke: #3598db;\" dy=\"48\" dx=\"340\" text-anchor=\"middle\"> {{vars.automatable}} <\/text> <\/g> <g> <circle cx=\"460\" cy=\"55\" r=\"10\" style=\"fill: #b0c4de; stroke: #3598db;\"><\/circle> <text x=\"410\" y=\"30\" style=\"font-size: 15px; fill: #FFFFFF;\">Technical Impact <\/text> <path id=\"chk3\" d=\"M 470,55 C 470,55 470,55 680,55\" style=\"stroke: #3598db; stroke-width: 2;\"><\/path> <text style=\"stroke: #3598db;\" dy=\"48\" dx=\"560\" text-anchor=\"middle\"> {{vars.technicalImpact}} <\/text> <\/g> <g> <circle cx=\"680\" cy=\"55\" r=\"10\" style=\"fill: #b0c4de; stroke: #3598db;\"><\/circle> <text x=\"620\" y=\"30\" style=\"font-size: 15px; fill: #FFFFFF;\">Mission &amp; Well-being <\/text> <path id=\"chk4\" d=\"M 690,55 C 690,55 690,55 900,55\" style=\"stroke: #3598db; stroke-width: 2;\"><\/path> <text style=\"stroke: #3598db;\" dy=\"48\" dx=\"780\" text-anchor=\"middle\"> {{vars.ssvcResult | lower}} <\/text> <\/g> <g> <circle cx=\"900\" cy=\"55\" r=\"10\" style=\"fill: {{vars.ssvcColor}}; stroke: #3598db;\"><\/circle> <text x=\"915\" y=\"50\" style=\"font-size: 15px; fill: {{vars.ssvcColor}};\">{{vars.ssvcFinalOutput}} <\/text> <\/g> <\/svg><\/p>\n<h4><span style=\"font-size: 14pt; color: #95a5a6;\"> <strong> <span class=\"font-primary-color\"> <span style=\"color: #3598db;\">VULNERABILITY SCORING DECISION<\/span> <br \/><\/span> <\/strong> <\/span><\/h4>\n<h6><span style=\"font-size: 14pt;\">{{vars.ssvcFinalOutput}}<\/span>: {{vars.ssvcText}}<\/h6>\n<h4><span style=\"font-size: 14pt; color: #95a5a6;\"> <strong> <span class=\"font-primary-color\"> <span style=\"color: #3598db;\">Automatable<\/span> <br \/><\/span> <\/strong> <\/span><\/h4>\n<h6><span style=\"font-size: 14pt;\">{{vars.automatable}} <\/span>: {{vars.automatableReason}}<\/h6>"
                },
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/k_e_v_alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1245",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "460ab726-d208-4e46-b391-11fa1940bfb1"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get SSVC Score",
            "description": null,
            "arguments": {
                "wellBeing": "{{vars.ssvc['Well Being']}}",
                "automatable": "{{vars.ssvc['Automatable']}}",
                "exploitation": "{{vars.ssvc['Exploitation']}}",
                "technicalImpact": "{{vars.ssvc['Technical Impact']}}",
                "mitigationStatus": "{{vars.ssvc['Mitigation Status']}}",
                "automatableReason": "{{vars.ssvc['Automatable Reason']}}",
                "missionPrevalence": "{{vars.ssvc['Mission Prevalence']}}"
            },
            "status": null,
            "top": "705",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "51cb84b9-fed7-4fbf-9ff1-618907bb90b5"
        },
        {
            "@type": "WorkflowStep",
            "name": "Calculation Message",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Stakeholder Specific Vulnerability Categorization (SSVC)",
                        "description": "<h5>The assigned tasks have been finished. The <i>Evaluation<\/i> tab will provide a calculation for the SSVC Score.<\/h5>",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "resources": "k_e_v_alerts",
                "owner_detail": {
                    "isAssigned": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Ok",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/51cb84b9-fed7-4fbf-9ff1-618907bb90b5"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                }
            },
            "status": null,
            "top": "570",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "780b35c4-037a-47a3-bc28-bc7907574559"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Incomplete Tasks",
            "description": null,
            "arguments": {
                "ssvc": "{{vars.input.records[0].sSVC | toDict }}",
                "incompleteTask": "{{ vars.correlatedData['tasks'] | json_query(\"[?contains(recordTags, 'Patch') != `true` && contains(recordTags, 'Recommended') != `true` && status != '\/api\/3\/picklists\/343f4b67-e929-4205-bf95-ba5b70545fed']\") }}"
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "9b7e6eae-ca76-4bcf-8436-a70397b3fb07"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Low Or Medium Or High",
            "description": null,
            "arguments": {
                "ssvcResult": "{{vars.ssvcOutput.get(vars.missionPrevalence).get(vars.wellBeing)}}"
            },
            "status": null,
            "top": "840",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "b6702a9a-cb6d-4c69-9475-f619be43ddaf"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Results",
            "description": null,
            "arguments": {
                "ssvcFinalOutput": "{{vars.ssvcFinalResult.get(vars.exploitation).get(vars.automatable).get(vars.technicalImpact).get(vars.ssvcResult | lower)}}"
            },
            "status": null,
            "top": "975",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "caedbbed-45ca-4c75-871a-3bfcce8c27ee"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Incomplete",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "No",
                        "step_iri": "\/api\/3\/workflow_steps\/3673cd56-0ba7-403e-afaa-781f3eb977be",
                        "condition": "{{ vars.incompleteTask | length > 0 }}",
                        "step_name": "Incomplete Tasks"
                    },
                    {
                        "option": "Yes",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/780b35c4-037a-47a3-bc28-bc7907574559",
                        "step_name": "Calculation Message"
                    }
                ]
            },
            "status": null,
            "top": "435",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "d66c548c-9ff7-47ac-ad25-2297f94b59c6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "ssvcOutput": "{\n  \"Minimal\": {\n    \"Minimal\": \"Low\",\n    \"Material\": \"Medium\",\n    \"Irreversible\": \"High\"\n  },\n  \"Support\": {\n    \"Minimal\": \"Medium\",\n    \"Material\": \"Medium\",\n    \"Irreversible\": \"High\"\n  },\n  \"Essential\": {\n    \"Minimal\": \"High\",\n    \"Material\": \"High\",\n    \"Irreversible\": \"High\"\n  }\n}",
                "correlatedData": "{{(vars.input.records[0]['@id']+\"?$relationships=true\") | fromIRI}}",
                "finalOutputtMap": "{\n  \"Track\":\"The vulnerability does not require action at this time. The organization would continue to track the vulnerability and reassess it if new information becomes available. CISA recommends remediating Track vulnerabilities within standard update timelines.\",\n  \"Track*\":\"The vulnerability contains specific characteristics that may require closer monitoring for changes. CISA recommends remediating Track* vulnerabilities within standard update timelines.\",\n  \"Attend\":\"The vulnerability requires attention from the organization's internal, supervisory-level individuals. Necessary actions may include requesting assistance or information about the vulnerability and may involve publishing a notification, either internally and\/or externally, about the vulnerability. CISA recommends remediating Attend vulnerabilities sooner than standard update timelines.\",\n  \"Act\":\"The vulnerability requires attention from the organization's internal, supervisory-level and leadership-level individuals. Necessary actions include requesting assistance or information about the vulnerability, as well as publishing a notification either internally and\/or externally. Typically, internal groups would meet to determine the overall response and then execute agreed upon actions. CISA recommends remediating Act vulnerabilities as soon as possible.\"\n}",
                "ssvcFinalResult": "{\n  \"poc\": {\n    \"no\": {\n      \"total\": {\n        \"low\": \"Track\",\n        \"high\": \"Attend\",\n        \"medium\": \"Track*\"\n      },\n      \"partial\": {\n        \"low\": \"Track\",\n        \"high\": \"Attend\",\n        \"medium\": \"Track\"\n      }\n    },\n    \"yes\": {\n      \"total\": {\n        \"low\": \"Track\",\n        \"high\": \"Attend\",\n        \"medium\": \"Track*\"\n      },\n      \"partial\": {\n        \"low\": \"Track\",\n        \"high\": \"Track*\",\n        \"medium\": \"Track\"\n      }\n    }\n  },\n  \"active\": {\n    \"no\": {\n      \"total\": {\n        \"low\": \"Attend\",\n        \"high\": \"Act\",\n        \"medium\": \"Act\"\n      },\n      \"partial\": {\n        \"low\": \"Attend\",\n        \"high\": \"Act\",\n        \"medium\": \"Attend\"\n      }\n    },\n    \"yes\": {\n      \"total\": {\n        \"low\": \"Track\",\n        \"high\": \"Act\",\n        \"medium\": \"Attend\"\n      },\n      \"partial\": {\n        \"low\": \"Track\",\n        \"high\": \"Attend\",\n        \"medium\": \"Track\"\n      }\n    }\n  }\n}"
            },
            "status": null,
            "top": "160",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "ea7c1969-20b8-4281-a16d-7259e2df9929"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/ea7c1969-20b8-4281-a16d-7259e2df9929",
            "sourceStep": "\/api\/3\/workflow_steps\/19be9823-6bb2-45fb-8958-a19d32635aff",
            "label": null,
            "isExecuted": false,
            "uuid": "348a729f-f851-416e-acdc-cacdaaf5b553"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get SSVC Color -> Update KEV Alert",
            "targetStep": "\/api\/3\/workflow_steps\/460ab726-d208-4e46-b391-11fa1940bfb1",
            "sourceStep": "\/api\/3\/workflow_steps\/277bb1bf-cd75-407e-bde7-2f0abd1bda61",
            "label": null,
            "isExecuted": false,
            "uuid": "0ad1a5f4-b98e-4f5c-863f-f80b110e545f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Incomplete Tasks -> Task Incomplete",
            "targetStep": "\/api\/3\/workflow_steps\/d66c548c-9ff7-47ac-ad25-2297f94b59c6",
            "sourceStep": "\/api\/3\/workflow_steps\/9b7e6eae-ca76-4bcf-8436-a70397b3fb07",
            "label": null,
            "isExecuted": false,
            "uuid": "3092a934-1757-426d-9bdf-589463078348"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Copy of Incomplete Tasks -> Get SSVC Score",
            "targetStep": "\/api\/3\/workflow_steps\/51cb84b9-fed7-4fbf-9ff1-618907bb90b5",
            "sourceStep": "\/api\/3\/workflow_steps\/780b35c4-037a-47a3-bc28-bc7907574559",
            "label": "Ok",
            "isExecuted": false,
            "uuid": "32f79fd8-189c-462d-8010-66b5883dbb5c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get SSVC Score -> Get Result",
            "targetStep": "\/api\/3\/workflow_steps\/b6702a9a-cb6d-4c69-9475-f619be43ddaf",
            "sourceStep": "\/api\/3\/workflow_steps\/51cb84b9-fed7-4fbf-9ff1-618907bb90b5",
            "label": null,
            "isExecuted": false,
            "uuid": "5212b18f-53a4-4685-ad32-1b1dbefe1ec7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Results -> Get SSVC Color",
            "targetStep": "\/api\/3\/workflow_steps\/277bb1bf-cd75-407e-bde7-2f0abd1bda61",
            "sourceStep": "\/api\/3\/workflow_steps\/caedbbed-45ca-4c75-871a-3bfcce8c27ee",
            "label": null,
            "isExecuted": false,
            "uuid": "60275f48-3859-41b1-bda1-f067ed394420"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get Incomplete Tasks",
            "targetStep": "\/api\/3\/workflow_steps\/9b7e6eae-ca76-4bcf-8436-a70397b3fb07",
            "sourceStep": "\/api\/3\/workflow_steps\/ea7c1969-20b8-4281-a16d-7259e2df9929",
            "label": null,
            "isExecuted": false,
            "uuid": "decc2802-1d9b-4bfc-9936-d0b3c5d70cac"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Low Or Medium Or High -> Get Results",
            "targetStep": "\/api\/3\/workflow_steps\/caedbbed-45ca-4c75-871a-3bfcce8c27ee",
            "sourceStep": "\/api\/3\/workflow_steps\/b6702a9a-cb6d-4c69-9475-f619be43ddaf",
            "label": null,
            "isExecuted": false,
            "uuid": "ded94b9a-00e8-4233-9273-e3208ef1aad4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Incomplete -> Copy of Incomplete Tasks",
            "targetStep": "\/api\/3\/workflow_steps\/780b35c4-037a-47a3-bc28-bc7907574559",
            "sourceStep": "\/api\/3\/workflow_steps\/d66c548c-9ff7-47ac-ad25-2297f94b59c6",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "dfa0d69f-4e45-4f39-b14e-d2bee53276f4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Incomplete -> Incomplete Tasks",
            "targetStep": "\/api\/3\/workflow_steps\/3673cd56-0ba7-403e-afaa-781f3eb977be",
            "sourceStep": "\/api\/3\/workflow_steps\/d66c548c-9ff7-47ac-ad25-2297f94b59c6",
            "label": "No",
            "isExecuted": false,
            "uuid": "eee48d6a-857a-4584-9d02-e5e1404c5145"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "8d84850b-7150-40af-939a-bc9d5f01462f",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Alert",
        "Calculate",
        "CVE",
        "ICS - Advisory",
        "KEV",
        "SSVC",
        "Tasks"
    ]
}