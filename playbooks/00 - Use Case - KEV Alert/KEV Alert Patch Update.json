{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "KEV Alert Patch Update",
    "aliasName": null,
    "tag": null,
    "description": null,
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/db7036e6-4e35-4479-beea-d7fefc73ab68",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/c3dec1c1-ca84-46fa-8b40-145e0286baa5",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Task Reconfiguring Firewalls",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.input.records[0].title}} - Reconfiguring firewalls to block access",
                    "type": "\/api\/3\/picklists\/30300411-a2e0-42dc-9180-513904f73ab9",
                    "assets": "{{vars.assetIRI}}",
                    "status": "\/api\/3\/picklists\/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "priority": "\/api\/3\/picklists\/90088ebe-0a7d-4aa6-9c9c-93b937a4e4f8",
                    "__replace": "",
                    "startDate": "{{arrow.utcnow().int_timestamp}}",
                    "recordTags": "{{vars.tagList}}",
                    "description": "Reconfiguring firewalls to block access"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.taskIRI.append(vars.result['@id'])}}"
                }
            },
            "status": null,
            "top": "705",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "12754137-492e-4366-a7bd-24c5c1450e42"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get IRIs And Add Tag List",
            "description": null,
            "arguments": {
                "tagList": "{% set data = vars.alertRecord['recordTags'] %}{% for item in vars.alertRecord['cVEs'] %}{% set _ = data.append(item['cVEID']) %}{% endfor %}{% set _ = data.append(\"Patch\") %}{{data}}",
                "assetIRI": "{{vars.alertRecord['asset'] | json_query('[*][\"@id\"][]')}}"
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "14e97a88-510b-4101-9b1d-8447cc281020"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Increase Monitoring",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.input.records[0].title}} - Increase monitoring to detect exploitation.",
                    "type": "\/api\/3\/picklists\/30300411-a2e0-42dc-9180-513904f73ab9",
                    "assets": "{{vars.assetIRI}}",
                    "status": "\/api\/3\/picklists\/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "priority": "\/api\/3\/picklists\/90088ebe-0a7d-4aa6-9c9c-93b937a4e4f8",
                    "__replace": "",
                    "startDate": "{{arrow.utcnow().int_timestamp}}",
                    "recordTags": "{{vars.tagList}}",
                    "description": "Increase monitoring to detect exploitation."
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.taskIRI.append(vars.result['@id'])}}"
                }
            },
            "status": null,
            "top": "840",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "52e2e00d-e4e5-43b2-8b9d-df3a3d5ef896"
        },
        {
            "@type": "WorkflowStep",
            "name": "Do Patch Exist",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/6131ab02-94d6-4d5e-85e2-853ebc96153e",
                        "condition": "{{ vars.patchExist == \"Yes\" }}",
                        "step_name": "Create Patch Task"
                    },
                    {
                        "option": "No",
                        "step_iri": "\/api\/3\/workflow_steps\/efc60d52-120e-46ed-ae51-0768f60fd27e",
                        "condition": "{{ vars.patchExist == \"No\" }}",
                        "step_name": "Task Disabling Services"
                    }
                ]
            },
            "status": null,
            "top": "435",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "6040c407-6fde-4936-83da-343070a396be"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Install Patch",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.input.records[0].title}} - Install Patch",
                    "type": "\/api\/3\/picklists\/30300411-a2e0-42dc-9180-513904f73ab9",
                    "assets": "{{vars.assetIRI}}",
                    "status": "\/api\/3\/picklists\/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "priority": "\/api\/3\/picklists\/90088ebe-0a7d-4aa6-9c9c-93b937a4e4f8",
                    "__replace": "",
                    "startDate": "{{arrow.utcnow().int_timestamp}}",
                    "recordTags": "{{vars.tagList}}",
                    "description": "Install Patch"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.taskIRI.append(vars.result['@id'])}}"
                }
            },
            "status": null,
            "top": "840",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "6131ab02-94d6-4d5e-85e2-853ebc96153e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "taskIRI": "[]",
                "patchExist": "{{vars.input.records[0].patchExist.itemValue}}",
                "alertRecord": "{{(vars.input.records[0]['@id']+ \"?$relationships=true\") | fromIRI}}"
            },
            "status": null,
            "top": "165",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "b250095b-7731-458b-87d9-0f5362cc7f26"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update KEV Alert",
            "description": null,
            "arguments": {
                "resource": {
                    "__link": {
                        "tasks": "{{vars.taskIRI}}"
                    },
                    "patchAssignment": "<h4>The patching tasks listed below were created on KEV Alert.<\/h4>\n<hr \/>\n<table>\n<tbody>\n<tr>\n<th style=\"width: 10%;\">Sr. No.<\/th>\n<th style=\"width: 80%;\">Task Name<\/th>\n<th style=\"width: 10%;\">Task Id<th>\n<\/tr>\n{% for item in vars.taskIRI %}\n<tbody>\n<tr>\n<td>{{loop.index}}<\/td>\n<td>{{(item | fromIRI).name}}<\/td>\n<td><a href=\"\/modules\/tasks\/{{item.split('\/')[-1]}}\">{{(item | fromIRI).id}}<\/a><\/td>\n<\/tr>\n<\/tbody>\n{% endfor %}\n<\/table>"
                },
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/k_e_v_alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "975",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "b78be2ff-1e8a-46fa-b5e0-b07f9bce40cb"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "resource": "k_e_v_alerts",
                "resources": [
                    "k_e_v_alerts"
                ],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    }
                },
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "object",
                            "field": "patchExist",
                            "value": "",
                            "_value": {
                                "@id": "",
                                "display": "",
                                "itemValue": ""
                            },
                            "operator": "changed"
                        },
                        {
                            "type": "object",
                            "field": "patchExist",
                            "value": "\/api\/3\/picklists\/27ff216f-6363-4c93-9fc4-e0e8c15cb0b1",
                            "_value": {
                                "@id": "\/api\/3\/picklists\/27ff216f-6363-4c93-9fc4-e0e8c15cb0b1",
                                "display": "Unknown",
                                "itemValue": "Unknown"
                            },
                            "operator": "neq"
                        }
                    ]
                }
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/9300bf69-5063-486d-b3a6-47eb9da24872",
            "group": null,
            "uuid": "c3dec1c1-ca84-46fa-8b40-145e0286baa5"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Disabling Services",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.input.records[0].title}} - Disabling services",
                    "type": "\/api\/3\/picklists\/30300411-a2e0-42dc-9180-513904f73ab9",
                    "assets": "{{vars.assetIRI}}",
                    "status": "\/api\/3\/picklists\/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "priority": "\/api\/3\/picklists\/90088ebe-0a7d-4aa6-9c9c-93b937a4e4f8",
                    "__replace": "",
                    "startDate": "{{arrow.utcnow().int_timestamp}}",
                    "recordTags": "{{vars.tagList}}",
                    "description": "Disabling services"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.taskIRI.append(vars.result['@id'])}}"
                }
            },
            "status": null,
            "top": "570",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "efc60d52-120e-46ed-ae51-0768f60fd27e"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Do Patch Exist -> Create Patch Task",
            "targetStep": "\/api\/3\/workflow_steps\/6131ab02-94d6-4d5e-85e2-853ebc96153e",
            "sourceStep": "\/api\/3\/workflow_steps\/6040c407-6fde-4936-83da-343070a396be",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "0efdeae4-e84d-4ab0-a058-7c043a26b9a9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Install Patch -> Update KEV Alert",
            "targetStep": "\/api\/3\/workflow_steps\/b78be2ff-1e8a-46fa-b5e0-b07f9bce40cb",
            "sourceStep": "\/api\/3\/workflow_steps\/6131ab02-94d6-4d5e-85e2-853ebc96153e",
            "label": null,
            "isExecuted": false,
            "uuid": "1894c996-0d1a-4259-9250-da86c5fa64bc"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get IRIs -> Do Patch Exist",
            "targetStep": "\/api\/3\/workflow_steps\/6040c407-6fde-4936-83da-343070a396be",
            "sourceStep": "\/api\/3\/workflow_steps\/14e97a88-510b-4101-9b1d-8447cc281020",
            "label": null,
            "isExecuted": false,
            "uuid": "287266a6-cf81-40f3-9975-94f840d7d7ab"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Increase Monitoring -> Update KEV Alert",
            "targetStep": "\/api\/3\/workflow_steps\/b78be2ff-1e8a-46fa-b5e0-b07f9bce40cb",
            "sourceStep": "\/api\/3\/workflow_steps\/52e2e00d-e4e5-43b2-8b9d-df3a3d5ef896",
            "label": null,
            "isExecuted": false,
            "uuid": "3f6fd8f1-d398-43d5-be7c-3a5b8b7279c8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Do Patch Exist -> Task Disabling Services",
            "targetStep": "\/api\/3\/workflow_steps\/efc60d52-120e-46ed-ae51-0768f60fd27e",
            "sourceStep": "\/api\/3\/workflow_steps\/6040c407-6fde-4936-83da-343070a396be",
            "label": "No",
            "isExecuted": false,
            "uuid": "5273b1fa-a99b-427f-9af9-a4486228dd06"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Disabling Services -> Copy of Task Disabling Services",
            "targetStep": "\/api\/3\/workflow_steps\/12754137-492e-4366-a7bd-24c5c1450e42",
            "sourceStep": "\/api\/3\/workflow_steps\/efc60d52-120e-46ed-ae51-0768f60fd27e",
            "label": null,
            "isExecuted": false,
            "uuid": "58ff47c3-1c1a-499f-b988-3661e9bf960a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get IRIs",
            "targetStep": "\/api\/3\/workflow_steps\/14e97a88-510b-4101-9b1d-8447cc281020",
            "sourceStep": "\/api\/3\/workflow_steps\/b250095b-7731-458b-87d9-0f5362cc7f26",
            "label": null,
            "isExecuted": false,
            "uuid": "7b9ad0a5-3dfb-49fc-95d5-22b34366f96e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/b250095b-7731-458b-87d9-0f5362cc7f26",
            "sourceStep": "\/api\/3\/workflow_steps\/c3dec1c1-ca84-46fa-8b40-145e0286baa5",
            "label": null,
            "isExecuted": false,
            "uuid": "bffe8524-4292-43d2-9786-7fda62305539"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Reconfiguring Firewalls -> Copy of Task Reconfiguring Firewalls",
            "targetStep": "\/api\/3\/workflow_steps\/52e2e00d-e4e5-43b2-8b9d-df3a3d5ef896",
            "sourceStep": "\/api\/3\/workflow_steps\/12754137-492e-4366-a7bd-24c5c1450e42",
            "label": null,
            "isExecuted": false,
            "uuid": "f003a45e-8d3a-44f7-bab4-e8b4d846062f"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "87adf3db-bb3c-4242-8e29-30783c6ec332",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Alert",
        "CVE",
        "ICS - Advisory",
        "KEV",
        "Patch"
    ]
}