{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "On Vulnerability Exploitation Update",
    "aliasName": null,
    "tag": null,
    "description": null,
    "isActive": false,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/db7036e6-4e35-4479-beea-d7fefc73ab68",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/aca7db2b-e7fe-4b81-94c1-8e2011c33429",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "taskIRI": "[]",
                "alertRecord": "{{(vars.input.records[0]['@id']+ \"?$relationships=true\") | fromIRI}}"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "14d13901-16c9-4ea3-a468-acf01e20065c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Incident Response Playbook",
            "description": null,
            "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": {
                    "tagList": "{{vars.alertRecord['recordTags']}}",
                    "assetIRI": "{{vars.alertRecord['asset'] | json_query('[*][\"@id\"][]')}}"
                },
                "pass_input_record": false,
                "workflowReference": "\/api\/3\/workflows\/06fa0eee-d444-410d-9d65-6b88a044d6d2"
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "2cc0505f-9ec8-4908-af18-a2406c9f0bfe"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Limiting access",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.input.records[0].title}} - Limiting access",
                    "assets": "{{vars.assetIRI}}",
                    "status": "\/api\/3\/picklists\/0d92127c-fed9-4c5c-a952-3f2803503cd2",
                    "__replace": "",
                    "recordTags": "{{vars.tagList}}"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.taskIRI.append(vars.result['@id'])}}"
                }
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "34bf2657-6be9-4305-961b-7bb9677c938f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Investigation Abnormal Activity",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.input.records[0].title}} - Investigation of any abnormal activity associated with vulnerable systems or services, including anomalous access attempts and behavior",
                    "status": "\/api\/3\/picklists\/0d92127c-fed9-4c5c-a952-3f2803503cd2",
                    "__replace": ""
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.taskIRI.append(vars.result['@id'])}}"
                }
            },
            "status": null,
            "top": "165",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "68260f48-0a16-4c66-9e91-f7819ea898a8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Sweep IOCs",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.input.records[0].title}} - Sweep known IOCs associated with exploitation of the vulnerability.",
                    "status": "\/api\/3\/picklists\/0d92127c-fed9-4c5c-a952-3f2803503cd2",
                    "__replace": ""
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.taskIRI.append(vars.result['@id'])}}"
                }
            },
            "status": null,
            "top": "30",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "7691bc72-5950-4d8b-b536-bbe218959de5"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Isolating Vulnerable Systems",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.input.records[0].title}} - Isolating vulnerable systems, applications, services, profiles, or other assets",
                    "assets": "{{vars.assetIRI}}",
                    "status": "\/api\/3\/picklists\/0d92127c-fed9-4c5c-a952-3f2803503cd2",
                    "__replace": "",
                    "recordTags": "{{vars.tagList}}"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.taskIRI.append(vars.result['@id'])}}"
                }
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "7fe3745f-1ad8-480e-af3a-1b262b6389be"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update KEV Alert",
            "description": null,
            "arguments": {
                "resource": {
                    "__link": {
                        "tasks": "{{vars.taskIRI}}"
                    },
                    "vulnerabilityMitigation": "<h4>The mitigation tasks listed below were created on KEV Alert.<\/h4>\n<hr \/>\n<table>\n<tbody>\n<tr>\n<th style=\"width: 10%;\">Sr. No.<\/th>\n<th style=\"width: 80%;\">Task Name<\/th>\n<th style=\"width: 10%;\">Task Id<th>\n<\/tr>\n{% for item in vars.taskIRI %}\n<tbody>\n<tr>\n<td>{{loop.index}}<\/td>\n<td>{{(item | fromIRI).name}}<\/td>\n<td><a href=\"\/modules\/tasks\/{{item.split('\/')[-1]}}\">{{(item | fromIRI).id}}<\/a><\/td>\n<\/tr>\n<\/tbody>\n{% endfor %}\n<\/table>"
                },
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/k_e_v_alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "840",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "93e3bb27-3453-4b74-859b-25b15319f76c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Permanent Configuration Changes",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.input.records[0].title}} - Make Permanent Configuration Changes",
                    "assets": "{{vars.assetIRI}}",
                    "status": "\/api\/3\/picklists\/0d92127c-fed9-4c5c-a952-3f2803503cd2",
                    "__replace": "",
                    "recordTags": "{{vars.tagList}}"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.taskIRI.append(vars.result['@id'])}}"
                }
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "9c9282cd-db09-44a1-857a-386f1d9b9541"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "resource": "k_e_v_alerts",
                "resources": [
                    "k_e_v_alerts"
                ],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    }
                },
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "object",
                            "field": "exploitationStatus",
                            "value": "",
                            "_value": {
                                "@id": "",
                                "display": "Unknown",
                                "itemValue": ""
                            },
                            "operator": "changed"
                        },
                        {
                            "type": "object",
                            "field": "exploitationStatus",
                            "value": "\/api\/3\/picklists\/946f7181-68c1-47c4-9b2e-b26c32a68af8",
                            "_value": {
                                "@id": "\/api\/3\/picklists\/946f7181-68c1-47c4-9b2e-b26c32a68af8",
                                "display": "Confirmed",
                                "itemValue": "Confirmed"
                            },
                            "operator": "eq"
                        }
                    ]
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/9300bf69-5063-486d-b3a6-47eb9da24872",
            "group": null,
            "uuid": "aca7db2b-e7fe-4b81-94c1-8e2011c33429"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update KEV Alert 02",
            "description": null,
            "arguments": {
                "resource": {
                    "__link": {
                        "tasks": "{{vars.taskIRI}}"
                    },
                    "vulnerabilityAssignment": "<h4>The tasks listed below were created on KEV Alert and are to be practised..<\/h4>\n<hr \/>\n<table>\n<tbody>\n<tr>\n<th>Sr. No.<\/th>\n<th>Task Name<\/th>\n<\/tr>\n{% for item in vars.taskIRI %}\n<tbody>\n<tr>\n<td>{{loop.index}}<\/td>\n<td>{{(item | fromIRI).name}}<\/td>\n<\/tr>\n<\/tbody>\n{% endfor %}\n<\/table>"
                },
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/k_e_v_alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "c9832e8a-433d-4d8d-89e6-5c63326e79f7"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Task Permanent Configuration Changes -> Copy 1 of Update Alert",
            "targetStep": "\/api\/3\/workflow_steps\/93e3bb27-3453-4b74-859b-25b15319f76c",
            "sourceStep": "\/api\/3\/workflow_steps\/9c9282cd-db09-44a1-857a-386f1d9b9541",
            "label": null,
            "isExecuted": false,
            "uuid": "0a75cfb1-3eb6-42b6-8d0b-dbe0167cd05d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Incident Response Playbook",
            "targetStep": "\/api\/3\/workflow_steps\/2cc0505f-9ec8-4908-af18-a2406c9f0bfe",
            "sourceStep": "\/api\/3\/workflow_steps\/14d13901-16c9-4ea3-a468-acf01e20065c",
            "label": null,
            "isExecuted": false,
            "uuid": "3126043b-bf42-4685-9031-d1769252a5ba"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Task 01 -> Copy 1 of Create Task 01",
            "targetStep": "\/api\/3\/workflow_steps\/68260f48-0a16-4c66-9e91-f7819ea898a8",
            "sourceStep": "\/api\/3\/workflow_steps\/7691bc72-5950-4d8b-b536-bbe218959de5",
            "label": null,
            "isExecuted": false,
            "uuid": "3eaaaaf3-84f8-40dc-a7a9-fffb58e53d8b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Incident Response Playbook -> Task Limiting access",
            "targetStep": "\/api\/3\/workflow_steps\/34bf2657-6be9-4305-961b-7bb9677c938f",
            "sourceStep": "\/api\/3\/workflow_steps\/2cc0505f-9ec8-4908-af18-a2406c9f0bfe",
            "label": null,
            "isExecuted": false,
            "uuid": "5ae4562a-3b34-4e5e-9eeb-bbbbc20fe404"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Investigation Abnormal Activity -> Update KEV Alert 02",
            "targetStep": "\/api\/3\/workflow_steps\/c9832e8a-433d-4d8d-89e6-5c63326e79f7",
            "sourceStep": "\/api\/3\/workflow_steps\/68260f48-0a16-4c66-9e91-f7819ea898a8",
            "label": null,
            "isExecuted": false,
            "uuid": "70ef1412-c502-4f9d-a361-d47dfa85571d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Isolating Vulnerable Systems -> Task Permanent Configuration Changes",
            "targetStep": "\/api\/3\/workflow_steps\/9c9282cd-db09-44a1-857a-386f1d9b9541",
            "sourceStep": "\/api\/3\/workflow_steps\/7fe3745f-1ad8-480e-af3a-1b262b6389be",
            "label": null,
            "isExecuted": false,
            "uuid": "89f4c894-b9fc-4086-8ec0-6655209e9fc3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Record Limiting access -> Isolating vulnerable systems",
            "targetStep": "\/api\/3\/workflow_steps\/7fe3745f-1ad8-480e-af3a-1b262b6389be",
            "sourceStep": "\/api\/3\/workflow_steps\/34bf2657-6be9-4305-961b-7bb9677c938f",
            "label": null,
            "isExecuted": false,
            "uuid": "f2640542-d8e7-44ca-8000-f188d5706e28"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/14d13901-16c9-4ea3-a468-acf01e20065c",
            "sourceStep": "\/api\/3\/workflow_steps\/aca7db2b-e7fe-4b81-94c1-8e2011c33429",
            "label": null,
            "isExecuted": false,
            "uuid": "fc9694fe-c2db-4332-83ac-188e0847a438"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "9ea9769c-2503-4c3e-b78f-faf925956e99",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": []
}