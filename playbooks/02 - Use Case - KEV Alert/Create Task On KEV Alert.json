{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Create Task On KEV Alert",
    "aliasName": null,
    "tag": null,
    "description": "This PB will create task on CVE to calculate SSVC Score",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "CVERecord",
        "KEVAlert",
        "ICSAdvisory",
        "assets"
    ],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/db7036e6-4e35-4479-beea-d7fefc73ab68",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/aad20786-3c52-4c3f-b93d-294575485b40",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Task Public Well Being Impact",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.record['cVEID']}} - Public Well-Being Impact",
                    "type": "\/api\/3\/picklists\/b862894c-0c3e-4668-866b-cd5fbab391dd",
                    "assets": "{{vars.input.params.assets | json_query('[*][\"@id\"][]')}}",
                    "status": "\/api\/3\/picklists\/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "priority": "\/api\/3\/picklists\/612befbc-4255-403a-958b-11efce3e1d8c",
                    "__replace": "",
                    "kEVAlerts": "{{vars.input.params.KEVAlert[\"@id\"]}}",
                    "startDate": "{{arrow.utcnow().int_timestamp}}",
                    "recordTags": "{{vars.tagList}}",
                    "description": "<p><h4>Impacts of Affected System Compromise on Humans <\/h4>\n<h5>Safety violations are those that negatively impact well-being. SVCC embraces the Centers for Disease Control (CDC) expansive definition of well-being, one that comprises physical, social, emotional, and psychological health. <\/h5><\/p>\n\n\n",
                    "iCSAdvisories": "{{vars.input.params.ICSAdvisory[\"@id\"]}}"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.recordIRI.append(vars.steps.Task_Public_Well_Being_Impact[\"@id\"])}}"
                }
            },
            "status": null,
            "top": "840",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "0580e152-b3bd-44b7-8c53-8d235ffd2b3b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Mission Prevalence",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.record['cVEID']}} - Mission Prevalence",
                    "type": "\/api\/3\/picklists\/5daef3ec-9619-4749-9069-23e04278d9ed",
                    "assets": "{{vars.input.params.assets | json_query('[*][\"@id\"][]')}}",
                    "status": "\/api\/3\/picklists\/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "priority": "\/api\/3\/picklists\/612befbc-4255-403a-958b-11efce3e1d8c",
                    "__replace": "",
                    "kEVAlerts": "{{vars.input.params.KEVAlert[\"@id\"]}}",
                    "startDate": "{{arrow.utcnow().int_timestamp}}",
                    "recordTags": "{{vars.tagList}}",
                    "description": "<p><h4>Impact on Mission Essential Functions of Relevant Entities <\/h4><h5>A mission essential function (MEF) is a function \"directly related to accomplishing the organization\u2019s mission as set forth in its statutory or executive charter.\u201d Identifying MEFs is part of business continuity planning or crisis planning. In contrast to non-essential functions, an organization \u201cmust perform a [MEF] during a disruption to normal operations.\u201d The mission is the reason an organization exists, and MEFs are how that mission is realized. Nonessential functions support the smooth delivery or success of MEFs rather than directly supporting the mission. <\/h5><\/p>\n\n",
                    "iCSAdvisories": "{{vars.input.params.ICSAdvisory[\"@id\"]}}"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.recordIRI.append(vars.steps.Task_Mission_Prevalence[\"@id\"])}}"
                }
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "6783a98f-169e-485e-bd14-09ee8bd6d6f6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Automatable",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.record['cVEID']}} - Automatable",
                    "type": "\/api\/3\/picklists\/d293fbd4-a479-43bf-8a6b-5857a855710c",
                    "assets": "{{vars.input.params.assets | json_query('[*][\"@id\"][]')}}",
                    "status": "\/api\/3\/picklists\/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "priority": "\/api\/3\/picklists\/612befbc-4255-403a-958b-11efce3e1d8c",
                    "__replace": "",
                    "kEVAlerts": "{{vars.input.params.KEVAlert[\"@id\"]}}",
                    "startDate": "{{arrow.utcnow().int_timestamp}}",
                    "recordTags": "{{vars.tagList}}",
                    "description": "<p><h5>Automatable represents the ease and speed with which a cyber threat actor can cause exploitation events. Automatable captures the answer to the question, \u201cCan an attacker reliably automate, creating exploitation events for this vulnerability?\u201d Several factors influence whether an actor can rapidly cause many exploitation events. These\ninclude attack complexity, the specific code an actor would need to write or configure themselves, and the usual network deployment of the vulnerable system (i.e., the usual exposure of the system).<\/h5><\/p>\n\n",
                    "iCSAdvisories": "{{vars.input.params.ICSAdvisory[\"@id\"]}}"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.recordIRI.append(vars.steps.Task_Automatable[\"@id\"])}}"
                }
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "84b4672c-4693-4a31-81e7-7ddd1dfe87e3"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task State Of Exploitation",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.record[\"cVEID\"]}} - State Of Exploitation",
                    "type": "\/api\/3\/picklists\/7b72ee74-7c27-44f3-a4d4-7cec74d6faf8",
                    "assets": "{{vars.input.params.assets | json_query('[*][\"@id\"][]')}}",
                    "status": "\/api\/3\/picklists\/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "priority": "\/api\/3\/picklists\/612befbc-4255-403a-958b-11efce3e1d8c",
                    "__replace": "",
                    "kEVAlerts": "{{vars.input.params.KEVAlert[\"@id\"]}}",
                    "startDate": "{{arrow.utcnow().int_timestamp}}",
                    "recordTags": "{{vars.tagList}}",
                    "description": "<p><h4><strong>Evidence of Active Exploitation of a Vulnerability.<\/h4>\n<h5>This measure determines the present state of exploitation of the vulnerability. It does not predict future exploitation or\nmeasure feasibility or ease of adversary development of future exploit code; rather, it acknowledges available\ninformation at time of analysis. As the current state of exploitation often changes over time, answers should be timestamped. Sources that can provide public reporting of active exploitation include the vendor\u2019s vulnerability\nnotification, the National Vulnerability Database (NVD) and links therein, bulletins from relevant information sharing\nand analysis centers (ISACs), and reliable threat reports that list either the CVE-ID or common name of the\nvulnerability.<\/h5><\/p>",
                    "iCSAdvisories": "{{vars.input.params.ICSAdvisory[\"@id\"]}}"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.recordIRI.append(vars.steps.Task_State_Of_Exploitation[\"@id\"])}}"
                }
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "8883d55e-5b35-4ab6-aad9-a73d39609096"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Technical Impact",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.record['cVEID']}} - Technical Impact",
                    "type": "\/api\/3\/picklists\/c57a765d-b72a-4d73-bb89-0366c7171db0",
                    "assets": "{{vars.input.params.assets | json_query('[*][\"@id\"][]')}}",
                    "status": "\/api\/3\/picklists\/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "priority": "\/api\/3\/picklists\/612befbc-4255-403a-958b-11efce3e1d8c",
                    "__replace": "",
                    "kEVAlerts": "{{vars.input.params.KEVAlert[\"@id\"]}}",
                    "startDate": "{{arrow.utcnow().int_timestamp}}",
                    "recordTags": "{{vars.tagList}}",
                    "description": "<p><h4>Technical Impact of Exploiting the Vulnerability.<\/h4>\n<h5>Technical impact is similar to the Common Vulnerability Scoring System (CVSS) base score\u2019s concept of \u201cseverity.\u201d When evaluating technical impact, the definition of scope is particularly important. The decision point, \"Total,\" is relative to the affected component where the vulnerability resides. If a vulnerability discloses authentication or authorization credentials to the system, this information disclosure should also be scored as \u201cTotal\u201d if those credentials give an adversary total control of the component.<\/h5><\/p>\n\n",
                    "iCSAdvisories": "{{vars.input.params.ICSAdvisory[\"@id\"]}}"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.recordIRI.append(vars.steps.Task_Technical_Impact[\"@id\"])}}"
                }
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "8dd16f7a-8e69-45b8-aeb9-5d156d95b21b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Task Mitigation Status",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "{{vars.record['cVEID']}} - Mitigation Status",
                    "type": "\/api\/3\/picklists\/c5ab630e-596e-4cc5-bc99-0933be50268e",
                    "assets": "{{vars.input.params.assets | json_query('[*][\"@id\"][]')}}",
                    "status": "\/api\/3\/picklists\/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "priority": "\/api\/3\/picklists\/612befbc-4255-403a-958b-11efce3e1d8c",
                    "__replace": "",
                    "kEVAlerts": "{{vars.input.params.KEVAlert[\"@id\"]}}",
                    "startDate": "{{arrow.utcnow().int_timestamp}}",
                    "recordTags": "{{vars.tagList}}",
                    "description": "<p><h4>Status of available Mitigations, Workarounds, or Fixes for the Vulnerability <\/h4><h5>Mitigation status measures the degree of difficulty to mitigate the vulnerability in a timely manner. There are three factors to consider availability, difficulty, and type.  <\/h5><\/p>",
                    "iCSAdvisories": "{{vars.input.params.ICSAdvisory[\"@id\"]}}"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "__dummy": "{{vars.recordIRI.append(vars.steps.Task_Mitigation_Status[\"@id\"])}}"
                }
            },
            "status": null,
            "top": "975",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "8ddb07ad-6811-4978-914d-c23d4c3b64e3"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "record": "{{vars.input.params.CVERecord}}",
                "tagList": "{% set tags = [] %}{% set _ = tags.extend((vars.input.params.CVERecord['cVEID'], \"KEV\", vars.input.params.ICSAdvisory.iCSCERTID, vars.input.params.ICSAdvisory.vendor)) %}{{tags}}",
                "recordIRI": "[]"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "a7c8097c-054a-4518-b4ff-2ade447c50e4"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": []
                    }
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "aad20786-3c52-4c3f-b93d-294575485b40"
        },
        {
            "@type": "WorkflowStep",
            "name": "Output",
            "description": null,
            "arguments": {
                "recordIRI": "{{vars.recordIRI}}"
            },
            "status": null,
            "top": "1245",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "b1291bba-4c1e-41d6-aff0-535be882bff9"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update CVE With Task IRI",
            "description": null,
            "arguments": {
                "resource": {
                    "__link": {
                        "tasks": "{{vars.recordIRI}}"
                    }
                },
                "operation": "Append",
                "collection": "{{vars.record['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/c_v_es",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1110",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "bb822138-4383-43df-b6a0-61bc01806963"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Task Mitigation Status -> Update CVE With Task IRI",
            "targetStep": "\/api\/3\/workflow_steps\/bb822138-4383-43df-b6a0-61bc01806963",
            "sourceStep": "\/api\/3\/workflow_steps\/8ddb07ad-6811-4978-914d-c23d4c3b64e3",
            "label": null,
            "isExecuted": false,
            "uuid": "0d9865fc-a35b-4a0f-9c09-9b7d4ee44c55"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/a7c8097c-054a-4518-b4ff-2ade447c50e4",
            "sourceStep": "\/api\/3\/workflow_steps\/aad20786-3c52-4c3f-b93d-294575485b40",
            "label": null,
            "isExecuted": false,
            "uuid": "53e3164b-e665-4a88-9ba6-b7446c94b0fa"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update CVE With Task IRI -> Output",
            "targetStep": "\/api\/3\/workflow_steps\/b1291bba-4c1e-41d6-aff0-535be882bff9",
            "sourceStep": "\/api\/3\/workflow_steps\/bb822138-4383-43df-b6a0-61bc01806963",
            "label": null,
            "isExecuted": false,
            "uuid": "7078d97d-1a1d-45f0-a8fa-97d9d463007a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Task State Of Exploitation",
            "targetStep": "\/api\/3\/workflow_steps\/8883d55e-5b35-4ab6-aad9-a73d39609096",
            "sourceStep": "\/api\/3\/workflow_steps\/a7c8097c-054a-4518-b4ff-2ade447c50e4",
            "label": null,
            "isExecuted": false,
            "uuid": "7a86fe6c-0064-42b5-991a-13b53d9f2a9f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task State Of Exploitation -> Copy of Task State Of Exploitation",
            "targetStep": "\/api\/3\/workflow_steps\/8dd16f7a-8e69-45b8-aeb9-5d156d95b21b",
            "sourceStep": "\/api\/3\/workflow_steps\/8883d55e-5b35-4ab6-aad9-a73d39609096",
            "label": null,
            "isExecuted": false,
            "uuid": "952b0bb9-c386-4b30-9575-85433eb8356c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Automatable -> Copy of Task Automatable",
            "targetStep": "\/api\/3\/workflow_steps\/6783a98f-169e-485e-bd14-09ee8bd6d6f6",
            "sourceStep": "\/api\/3\/workflow_steps\/84b4672c-4693-4a31-81e7-7ddd1dfe87e3",
            "label": null,
            "isExecuted": false,
            "uuid": "9cfb05d9-a01e-47c7-8184-e71e208a71c9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Mission Prevalence -> Copy of Task Mission Prevalence",
            "targetStep": "\/api\/3\/workflow_steps\/0580e152-b3bd-44b7-8c53-8d235ffd2b3b",
            "sourceStep": "\/api\/3\/workflow_steps\/6783a98f-169e-485e-bd14-09ee8bd6d6f6",
            "label": null,
            "isExecuted": false,
            "uuid": "d1848118-f95c-4331-b859-cad5be2fce58"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Technical Impact -> Copy of Task Technical Impact",
            "targetStep": "\/api\/3\/workflow_steps\/84b4672c-4693-4a31-81e7-7ddd1dfe87e3",
            "sourceStep": "\/api\/3\/workflow_steps\/8dd16f7a-8e69-45b8-aeb9-5d156d95b21b",
            "label": null,
            "isExecuted": false,
            "uuid": "e0fbf11b-c754-4219-9ba9-2f8fdd053e79"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Task Public Well Being Impact -> Copy of Task Public Well Being Impact",
            "targetStep": "\/api\/3\/workflow_steps\/8ddb07ad-6811-4978-914d-c23d4c3b64e3",
            "sourceStep": "\/api\/3\/workflow_steps\/0580e152-b3bd-44b7-8c53-8d235ffd2b3b",
            "label": null,
            "isExecuted": false,
            "uuid": "fbe6aeb1-f477-4e5c-b595-19367935a7d7"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "8e8bd1de-f612-4a7d-a526-7faf353a0c7a",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Alert",
        "CVE",
        "ICS - Advisory",
        "KEV",
        "OT IT",
        "SSVC - Score"
    ]
}